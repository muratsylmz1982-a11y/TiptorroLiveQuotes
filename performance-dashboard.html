<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>TTQuotes Performance Dashboard</title>
    <!-- CSP: erlaubt nur lokale Ressourcen -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; connect-src 'self'; object-src 'none'; base-uri 'self'; form-action 'self';">
    <!-- CSP: Enhanced with object-src, base-uri, form-action for additional security -->
    <style>
        :root{
          --bg:#000;--panel:#111;--panel-grad:linear-gradient(145deg,#151515,#0d0d0d);
          --border:#333;--green:#22c55e;--green-dark:#269947;--gray:#737373;
          --red:#eb243a;--orange:#f59e0b;--card-radius:12px
        }
        body{font-family:Inter,Arial,sans-serif;background:var(--bg);color:#fff;margin:0;padding:20px;overflow-x:hidden}
        .header h1{color:var(--green-dark);margin:0;font-size:28px}
        .btn{background:var(--green-dark);border:0;padding:10px 20px;border-radius:6px;cursor:pointer;font-size:14px}
        .btn:hover{background:var(--green)}
        .btn.secondary{background:#333;color:#eee}
        .metrics-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:18px;margin-top:18px}
        .gpu-enabled{color:var(--green)}
        .gpu-partial{color:var(--orange)}
        .gpu-unknown{color:var(--gray)}
        .metric-card{background:var(--panel);border:1px solid var(--border);border-radius:12px;padding:16px;box-shadow:inset 0 1px 0 rgba(255,255,255,0.03)}
        .metric-title{font-weight:700;color:var(--green-dark);letter-spacing:.03em;margin-bottom:6px}
        .metric-value{font-size:34px;font-weight:800}
        .metric-label{font-size:12px;color:var(--gray)}
        .status-card .metric-value{font-size:28px}
        .logs{background:#0a0a0a;border:1px solid var(--border);border-radius:12px;height:220px;overflow:auto;padding:15px;font-family:Consolas,monospace;font-size:12px}
        @media(max-width:1000px){.metrics-grid{grid-template-columns:repeat(2,1fr)}}
        @media(max-width:700px){.metrics-grid{grid-template-columns:1fr}}
        .info { opacity: .7; margin-left: 6px; cursor: help; font-weight: 700; }
    </style>
</head>
<body>
    <div class="header">
        <h1>üéØ TTQuotes Performance Dashboard</h1>
        <button class="btn refresh-btn" id="refreshBtn">üîÑ Aktualisieren</button>
        <button class="btn secondary refresh-btn" id="clearLogsBtn">üóëÔ∏è Logs l√∂schen</button>
    </div>
    <div class="metrics-grid">
        <div class="metric-card">
            <div class="metric-title">Laufzeit</div>
            <div class="metric-value" id="uptime">-</div>
            <div class="metric-label">Seit App-Start</div>
        </div>
        <div class="metric-card">
            <div class="metric-title">Aktueller Speicher</div>
            <div class="metric-value" id="currentMemory">-</div>
            <div class="metric-label">
              Heap verwendet
             <span id="rssInfo" class="info" title="Prozess-RAM (RSS): ‚Äì">‚ìò</span>
           </div>
        </div>
        <div class="metric-card">
            <div class="metric-title">Durchschnittsspeicher</div>
            <div class="metric-value" id="averageMemory">-</div>
            <div class="metric-label">√úber alle Messungen</div>
        </div>
        <div class="metric-card">
            <div class="metric-title">Speicher-Peak</div>
            <div class="metric-value" id="peakMemory">-</div>
            <div class="metric-label">H√∂chster Wert</div>
        </div>
        <div class="metric-card">
            <div class="metric-title">GPU-Beschleunigung</div>
            <div class="metric-value" id="gpuStatus">-</div>
            <div class="metric-label" id="gpuDetails">-</div>
        </div>
        <div class="metric-card">
            <div class="metric-title">VRAM (Total)</div>
            <div class="metric-value" id="vramTotal">-</div>
            <div class="metric-label" id="vramDetails">-</div>
        </div>
        <div class="metric-card status-card" style="grid-column: span 2; max-width: 300px;">
            <div class="metric-title">System-Status</div>
            <div class="metric-value" id="systemStatus">-</div>
            <div class="metric-label" id="lastUpdate">-</div>
        </div>
    </div>
    <div class="metric-card" style="margin-top:18px;">
        <div class="metric-title">Performance Logs</div>
        <div class="logs" id="perfLogs">Dashboard wird geladen...</div>
    </div>
    <script src="./perf-dashboard.client.js" defer></script>
</body>
</html>
